import SE from '../../components/simulation_element/se';
import filtrador from '@/chemical_components/filtrador.svg';
import FiltracaoMassBalance from './filtracao_mass_balance';
import TabelaLeitoFiltrante from './tabela_leito_filtrante';
import TabelaCamadaSuporte from './tabela_camada_suporte';
import { Box, Flex, Heading, Text } from '@chakra-ui/react';

const DecantacaoDimensionElement: React.FC = () => {
  return (
    <Box my={2}>
      <svg width="100%" height="220" viewBox="0 0 632 220" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M155.408 82.572H159.74V83.604H155.408V82.572ZM155.528 87H154.328V78.6H160.256V79.644H155.528V87ZM161.778 87V80.64H162.93V87H161.778ZM162.354 79.416C162.13 79.416 161.942 79.344 161.79 79.2C161.646 79.056 161.574 78.88 161.574 78.672C161.574 78.456 161.646 78.276 161.79 78.132C161.942 77.988 162.13 77.916 162.354 77.916C162.578 77.916 162.762 77.988 162.906 78.132C163.058 78.268 163.134 78.44 163.134 78.648C163.134 78.864 163.062 79.048 162.918 79.2C162.774 79.344 162.586 79.416 162.354 79.416ZM165.129 87V78.096H166.281V87H165.129ZM170.829 87.072C170.189 87.072 169.693 86.9 169.341 86.556C168.989 86.212 168.813 85.72 168.813 85.08V79.248H169.965V85.032C169.965 85.376 170.049 85.64 170.217 85.824C170.393 86.008 170.641 86.1 170.961 86.1C171.321 86.1 171.621 86 171.861 85.8L172.221 86.628C172.045 86.78 171.833 86.892 171.585 86.964C171.345 87.036 171.093 87.072 170.829 87.072ZM167.733 81.588V80.64H171.789V81.588H167.733ZM173.613 87V80.64H174.717V82.368L174.609 81.936C174.785 81.496 175.081 81.16 175.497 80.928C175.913 80.696 176.425 80.58 177.033 80.58V81.696C176.985 81.688 176.937 81.684 176.889 81.684C176.849 81.684 176.809 81.684 176.769 81.684C176.153 81.684 175.665 81.868 175.305 82.236C174.945 82.604 174.765 83.136 174.765 83.832V87H173.613ZM181.119 87.072C180.479 87.072 179.911 86.932 179.415 86.652C178.919 86.372 178.527 85.988 178.239 85.5C177.951 85.004 177.807 84.444 177.807 83.82C177.807 83.188 177.951 82.628 178.239 82.14C178.527 81.652 178.919 81.272 179.415 81C179.911 80.72 180.479 80.58 181.119 80.58C181.751 80.58 182.315 80.72 182.811 81C183.315 81.272 183.707 81.652 183.987 82.14C184.275 82.62 184.419 83.18 184.419 83.82C184.419 84.452 184.275 85.012 183.987 85.5C183.707 85.988 183.315 86.372 182.811 86.652C182.315 86.932 181.751 87.072 181.119 87.072ZM181.119 86.064C181.527 86.064 181.891 85.972 182.211 85.788C182.539 85.604 182.795 85.344 182.979 85.008C183.163 84.664 183.255 84.268 183.255 83.82C183.255 83.364 183.163 82.972 182.979 82.644C182.795 82.308 182.539 82.048 182.211 81.864C181.891 81.68 181.527 81.588 181.119 81.588C180.711 81.588 180.347 81.68 180.027 81.864C179.707 82.048 179.451 82.308 179.259 82.644C179.067 82.972 178.971 83.364 178.971 83.82C178.971 84.268 179.067 84.664 179.259 85.008C179.451 85.344 179.707 85.604 180.027 85.788C180.347 85.972 180.711 86.064 181.119 86.064ZM188.131 87L191.935 78.6H193.123L196.939 87H195.679L192.283 79.272H192.763L189.367 87H188.131ZM189.751 84.9L190.075 83.94H194.803L195.151 84.9H189.751Z"
          fill="black"
        />
        <path
          d="M559.846 82.572H564.178V83.604H559.846V82.572ZM559.966 87H558.766V78.6H564.694V79.644H559.966V87ZM566.215 87V80.64H567.367V87H566.215ZM566.791 79.416C566.567 79.416 566.379 79.344 566.227 79.2C566.083 79.056 566.011 78.88 566.011 78.672C566.011 78.456 566.083 78.276 566.227 78.132C566.379 77.988 566.567 77.916 566.791 77.916C567.015 77.916 567.199 77.988 567.343 78.132C567.495 78.268 567.571 78.44 567.571 78.648C567.571 78.864 567.499 79.048 567.355 79.2C567.211 79.344 567.023 79.416 566.791 79.416ZM569.567 87V78.096H570.719V87H569.567ZM575.266 87.072C574.626 87.072 574.13 86.9 573.778 86.556C573.426 86.212 573.25 85.72 573.25 85.08V79.248H574.402V85.032C574.402 85.376 574.486 85.64 574.654 85.824C574.83 86.008 575.078 86.1 575.398 86.1C575.758 86.1 576.058 86 576.298 85.8L576.658 86.628C576.482 86.78 576.27 86.892 576.022 86.964C575.782 87.036 575.53 87.072 575.266 87.072ZM572.17 81.588V80.64H576.226V81.588H572.17ZM578.051 87V80.64H579.155V82.368L579.047 81.936C579.223 81.496 579.519 81.16 579.935 80.928C580.351 80.696 580.863 80.58 581.471 80.58V81.696C581.423 81.688 581.375 81.684 581.327 81.684C581.287 81.684 581.247 81.684 581.207 81.684C580.591 81.684 580.103 81.868 579.743 82.236C579.383 82.604 579.203 83.136 579.203 83.832V87H578.051ZM585.556 87.072C584.916 87.072 584.348 86.932 583.852 86.652C583.356 86.372 582.964 85.988 582.676 85.5C582.388 85.004 582.244 84.444 582.244 83.82C582.244 83.188 582.388 82.628 582.676 82.14C582.964 81.652 583.356 81.272 583.852 81C584.348 80.72 584.916 80.58 585.556 80.58C586.188 80.58 586.752 80.72 587.248 81C587.752 81.272 588.144 81.652 588.424 82.14C588.712 82.62 588.856 83.18 588.856 83.82C588.856 84.452 588.712 85.012 588.424 85.5C588.144 85.988 587.752 86.372 587.248 86.652C586.752 86.932 586.188 87.072 585.556 87.072ZM585.556 86.064C585.964 86.064 586.328 85.972 586.648 85.788C586.976 85.604 587.232 85.344 587.416 85.008C587.6 84.664 587.692 84.268 587.692 83.82C587.692 83.364 587.6 82.972 587.416 82.644C587.232 82.308 586.976 82.048 586.648 81.864C586.328 81.68 585.964 81.588 585.556 81.588C585.148 81.588 584.784 81.68 584.464 81.864C584.144 82.048 583.888 82.308 583.696 82.644C583.504 82.972 583.408 83.364 583.408 83.82C583.408 84.268 583.504 84.664 583.696 85.008C583.888 85.344 584.144 85.604 584.464 85.788C584.784 85.972 585.148 86.064 585.556 86.064ZM593.84 87V78.6H597.38C598.276 78.6 599.064 78.776 599.744 79.128C600.432 79.48 600.964 79.972 601.34 80.604C601.724 81.236 601.916 81.968 601.916 82.8C601.916 83.632 601.724 84.364 601.34 84.996C600.964 85.628 600.432 86.12 599.744 86.472C599.064 86.824 598.276 87 597.38 87H593.84ZM595.04 85.956H597.308C598.004 85.956 598.604 85.824 599.108 85.56C599.62 85.296 600.016 84.928 600.296 84.456C600.576 83.976 600.716 83.424 600.716 82.8C600.716 82.168 600.576 81.616 600.296 81.144C600.016 80.672 599.62 80.304 599.108 80.04C598.604 79.776 598.004 79.644 597.308 79.644H595.04V85.956Z"
          fill="black"
        />
        <path
          d="M423.467 82.572H427.799V83.604H423.467V82.572ZM423.587 87H422.387V78.6H428.315V79.644H423.587V87ZM429.836 87V80.64H430.988V87H429.836ZM430.412 79.416C430.188 79.416 430 79.344 429.848 79.2C429.704 79.056 429.632 78.88 429.632 78.672C429.632 78.456 429.704 78.276 429.848 78.132C430 77.988 430.188 77.916 430.412 77.916C430.636 77.916 430.82 77.988 430.964 78.132C431.116 78.268 431.192 78.44 431.192 78.648C431.192 78.864 431.12 79.048 430.976 79.2C430.832 79.344 430.644 79.416 430.412 79.416ZM433.188 87V78.096H434.34V87H433.188ZM438.887 87.072C438.247 87.072 437.751 86.9 437.399 86.556C437.047 86.212 436.871 85.72 436.871 85.08V79.248H438.023V85.032C438.023 85.376 438.107 85.64 438.275 85.824C438.451 86.008 438.699 86.1 439.019 86.1C439.379 86.1 439.679 86 439.919 85.8L440.279 86.628C440.103 86.78 439.891 86.892 439.643 86.964C439.403 87.036 439.151 87.072 438.887 87.072ZM435.791 81.588V80.64H439.847V81.588H435.791ZM441.672 87V80.64H442.776V82.368L442.668 81.936C442.844 81.496 443.14 81.16 443.556 80.928C443.972 80.696 444.484 80.58 445.092 80.58V81.696C445.044 81.688 444.996 81.684 444.948 81.684C444.908 81.684 444.868 81.684 444.828 81.684C444.212 81.684 443.724 81.868 443.364 82.236C443.004 82.604 442.824 83.136 442.824 83.832V87H441.672ZM449.177 87.072C448.537 87.072 447.969 86.932 447.473 86.652C446.977 86.372 446.585 85.988 446.297 85.5C446.009 85.004 445.865 84.444 445.865 83.82C445.865 83.188 446.009 82.628 446.297 82.14C446.585 81.652 446.977 81.272 447.473 81C447.969 80.72 448.537 80.58 449.177 80.58C449.809 80.58 450.373 80.72 450.869 81C451.373 81.272 451.765 81.652 452.045 82.14C452.333 82.62 452.477 83.18 452.477 83.82C452.477 84.452 452.333 85.012 452.045 85.5C451.765 85.988 451.373 86.372 450.869 86.652C450.373 86.932 449.809 87.072 449.177 87.072ZM449.177 86.064C449.585 86.064 449.949 85.972 450.269 85.788C450.597 85.604 450.853 85.344 451.037 85.008C451.221 84.664 451.313 84.268 451.313 83.82C451.313 83.364 451.221 82.972 451.037 82.644C450.853 82.308 450.597 82.048 450.269 81.864C449.949 81.68 449.585 81.588 449.177 81.588C448.769 81.588 448.405 81.68 448.085 81.864C447.765 82.048 447.509 82.308 447.317 82.644C447.125 82.972 447.029 83.364 447.029 83.82C447.029 84.268 447.125 84.664 447.317 85.008C447.509 85.344 447.765 85.604 448.085 85.788C448.405 85.972 448.769 86.064 449.177 86.064ZM461.217 87.096C460.577 87.096 459.985 86.992 459.441 86.784C458.905 86.568 458.437 86.268 458.037 85.884C457.645 85.492 457.337 85.036 457.113 84.516C456.889 83.996 456.777 83.424 456.777 82.8C456.777 82.176 456.889 81.604 457.113 81.084C457.337 80.564 457.649 80.112 458.049 79.728C458.449 79.336 458.917 79.036 459.453 78.828C459.997 78.612 460.589 78.504 461.229 78.504C461.877 78.504 462.473 78.616 463.017 78.84C463.569 79.056 464.037 79.38 464.421 79.812L463.641 80.568C463.321 80.232 462.961 79.984 462.561 79.824C462.161 79.656 461.733 79.572 461.277 79.572C460.805 79.572 460.365 79.652 459.957 79.812C459.557 79.972 459.209 80.196 458.913 80.484C458.617 80.772 458.385 81.116 458.217 81.516C458.057 81.908 457.977 82.336 457.977 82.8C457.977 83.264 458.057 83.696 458.217 84.096C458.385 84.488 458.617 84.828 458.913 85.116C459.209 85.404 459.557 85.628 459.957 85.788C460.365 85.948 460.805 86.028 461.277 86.028C461.733 86.028 462.161 85.948 462.561 85.788C462.961 85.62 463.321 85.364 463.641 85.02L464.421 85.776C464.037 86.208 463.569 86.536 463.017 86.76C462.473 86.984 461.873 87.096 461.217 87.096Z"
          fill="black"
        />
        <path
          d="M292.262 82.572H296.594V83.604H292.262V82.572ZM292.382 87H291.182V78.6H297.11V79.644H292.382V87ZM298.631 87V80.64H299.783V87H298.631ZM299.207 79.416C298.983 79.416 298.795 79.344 298.643 79.2C298.499 79.056 298.427 78.88 298.427 78.672C298.427 78.456 298.499 78.276 298.643 78.132C298.795 77.988 298.983 77.916 299.207 77.916C299.431 77.916 299.615 77.988 299.759 78.132C299.911 78.268 299.987 78.44 299.987 78.648C299.987 78.864 299.915 79.048 299.771 79.2C299.627 79.344 299.439 79.416 299.207 79.416ZM301.983 87V78.096H303.135V87H301.983ZM307.682 87.072C307.042 87.072 306.546 86.9 306.194 86.556C305.842 86.212 305.666 85.72 305.666 85.08V79.248H306.818V85.032C306.818 85.376 306.902 85.64 307.07 85.824C307.246 86.008 307.494 86.1 307.814 86.1C308.174 86.1 308.474 86 308.714 85.8L309.074 86.628C308.898 86.78 308.686 86.892 308.438 86.964C308.198 87.036 307.946 87.072 307.682 87.072ZM304.586 81.588V80.64H308.642V81.588H304.586ZM310.467 87V80.64H311.571V82.368L311.463 81.936C311.639 81.496 311.935 81.16 312.351 80.928C312.767 80.696 313.279 80.58 313.887 80.58V81.696C313.839 81.688 313.791 81.684 313.743 81.684C313.703 81.684 313.663 81.684 313.623 81.684C313.007 81.684 312.519 81.868 312.159 82.236C311.799 82.604 311.619 83.136 311.619 83.832V87H310.467ZM317.972 87.072C317.332 87.072 316.764 86.932 316.268 86.652C315.772 86.372 315.38 85.988 315.092 85.5C314.804 85.004 314.66 84.444 314.66 83.82C314.66 83.188 314.804 82.628 315.092 82.14C315.38 81.652 315.772 81.272 316.268 81C316.764 80.72 317.332 80.58 317.972 80.58C318.604 80.58 319.168 80.72 319.664 81C320.168 81.272 320.56 81.652 320.84 82.14C321.128 82.62 321.272 83.18 321.272 83.82C321.272 84.452 321.128 85.012 320.84 85.5C320.56 85.988 320.168 86.372 319.664 86.652C319.168 86.932 318.604 87.072 317.972 87.072ZM317.972 86.064C318.38 86.064 318.744 85.972 319.064 85.788C319.392 85.604 319.648 85.344 319.832 85.008C320.016 84.664 320.108 84.268 320.108 83.82C320.108 83.364 320.016 82.972 319.832 82.644C319.648 82.308 319.392 82.048 319.064 81.864C318.744 81.68 318.38 81.588 317.972 81.588C317.564 81.588 317.2 81.68 316.88 81.864C316.56 82.048 316.304 82.308 316.112 82.644C315.92 82.972 315.824 83.364 315.824 83.82C315.824 84.268 315.92 84.664 316.112 85.008C316.304 85.344 316.56 85.604 316.88 85.788C317.2 85.972 317.564 86.064 317.972 86.064ZM326.256 87V78.6H330.024C330.992 78.6 331.736 78.796 332.256 79.188C332.776 79.572 333.036 80.1 333.036 80.772C333.036 81.228 332.932 81.612 332.724 81.924C332.524 82.236 332.252 82.476 331.908 82.644C331.564 82.812 331.192 82.896 330.792 82.896L331.008 82.536C331.488 82.536 331.912 82.62 332.28 82.788C332.648 82.956 332.94 83.204 333.156 83.532C333.372 83.852 333.48 84.252 333.48 84.732C333.48 85.452 333.208 86.012 332.664 86.412C332.128 86.804 331.328 87 330.264 87H326.256ZM327.456 86.028H330.216C330.88 86.028 331.388 85.916 331.74 85.692C332.092 85.468 332.268 85.116 332.268 84.636C332.268 84.148 332.092 83.792 331.74 83.568C331.388 83.344 330.88 83.232 330.216 83.232H327.348V82.26H329.916C330.524 82.26 330.996 82.148 331.332 81.924C331.668 81.7 331.836 81.364 331.836 80.916C331.836 80.468 331.668 80.132 331.332 79.908C330.996 79.684 330.524 79.572 329.916 79.572H327.456V86.028Z"
          fill="black"
        />
        <path
          d="M631 46V1H1V46C9.39051 46 43.173 46 92 46M631 46V150M631 46C599.737 46 563.301 46 524 46M92 46V150H631M92 46C101.16 46 110.849 46 121 46M631 150V217C594.667 218.667 522.4 221 524 217C525.6 213 524.667 101.333 524 46M524 46C514.813 46 505.47 46 496 46M496 46V217H390V46M496 46C461.859 46 426.066 46 390 46M390 46C381.01 46 372.003 46 363 46M363 46V217H254V46M363 46C326.102 46 289.278 46 254 46M254 46C245.23 46 236.556 46 228 46M228 46C189.203 46 152.833 46 121 46M228 46V114M121 46V114M121 114V217H228V114M121 114H228"
          stroke="black"
        />
        <path d="M254.5 114H363M390 114H496M525 114H631" stroke="black" />
        <path d="M589 23H553M553 23L562 13M553 23L562 34" stroke="#38B2AC" />
        <path d="M370 23H334M334 23L343 13M334 23L343 34" stroke="#38B2AC" />
        <path d="M175 23H139M139 23L148 13M139 23L148 34" stroke="#38B2AC" />
        <path d="M598 129H562M562 129L571 119M562 129L571 140" stroke="#38B2AC" />
        <path d="M461 129H425M425 129L434 119M425 129L434 140" stroke="#38B2AC" />
        <path d="M334 129H298M298 129L307 119M298 129L307 140" stroke="#38B2AC" />
        <path d="M191 129H155M155 129L164 119M155 129L164 140" stroke="#38B2AC" />
        <path d="M107 114L107 78M107 78L117 87M107 78L96 87" stroke="#38B2AC" />
        <path d="M241.381 113V78M241.381 78L249 86.75M241.381 78L233 86.75" stroke="#38B2AC" />
        <path d="M510.381 110V75M510.381 75L518 83.75M510.381 75L502 83.75" stroke="#38B2AC" />
        <path d="M376.381 110V75M376.381 75L384 83.75M376.381 75L368 83.75" stroke="#38B2AC" />
      </svg>
    </Box>
  );
};

export const filtracaoElement = new SE(
  'Filtração',
  { x: 1020, y: 80 },
  {
    availableTransformers: ['areia', 'antracito'],
    image: filtrador,
    connections: { right: 'source', left: 'target' },
    transformerColor: 'purple',
    massBalances: [
      {
        id: 'mb-filtracao',
        name: 'Balanço de Massa da Filtração',
        content: <FiltracaoMassBalance />,
      },
    ],
    dimensionElement: <DecantacaoDimensionElement />,
    dimensionsBottomElement: (
      <Box>
        <Heading fontSize={16} fontWeight={500} mt={8} textAlign={'center'}>
          Dimensões padronizadas do leito filtrante
        </Heading>
          <Text fontSize={10} fontWeight={200} textAlign={'center'} mt={2} mb={8}>
              Richter e Azevedo Netto (1991)
          </Text>
        <Flex flexDirection={'column'}>
          <Box flex={1}>
            <TabelaLeitoFiltrante />
          </Box>
          <Box flex={1}>
            <TabelaCamadaSuporte />
          </Box>
        </Flex>
      </Box>
    ),
    calculations: [
      {
        name: 'Vazão de Água Filtrada',
        variable: 'QAF',
        formula: 'QAF = QE - QR',
        hideOnSidebar: true,
        showOnScreen: true,
        measurement: 'm³/h',
        calculationMethod: (values, _transformers, setValues) => {
          // vazao de agua coagulada
          const QAC = values['QAC'];

          // vazao de agua decantada
          const QL = 0.02 * QAC;
          const QE = QAC - QL;

          // calculo local
          const QR = 0.02 * QE;

          const QAF = QE - QR;

          values.QAF = QAF;
          setTimeout(() => {
            setValues(values);
          }, 0);

          return QAF;
        },
      },
      {
        name: 'Taxa de filtração',
        variable: 'TF',
        formula: 'TF = 240',
        measurement: 'm³/m².d',
        calculationMethod: () => {
          const TF = 240;

          return TF;
        },
      },
      {
        name: 'Área total de filtração',
        variable: 'At',
        formula: 'At = QE / TF',
        measurement: 'm²',
        calculationMethod: (values) => {
          const QE = values['QE'] * 16;
          const TF = 240;

          const At = QE / TF;

          return Number(At.toFixed(2));
        },
      },
      {
        name: 'Área de cada filtro',
        variable: 'Af',
        formula: 'Af = 2',
        measurement: 'm²',
        calculationMethod: () => {
          return 2;
        },
      },
      {
        name: 'Número de filtros',
        variable: 'Nf',
        formula: 'Nf = At / Af',
        measurement: '',
        calculationMethod: (values) => {
          const At = values['At'];
          const Af = values['Af'];

          const Nf = At / Af;

          return Math.ceil(Nf);
        },
      },
      {
        name: 'Largura do filtro',
        variable: 'Lf',
        formula: 'Lf = 1',
        measurement: 'm',
        calculationMethod: () => {
          return 2;
        },
      },
      {
        name: 'Comprimento do filtro',
        variable: 'Cf',
        formula: 'Cf = Af / Lf',
        measurement: 'm',
        calculationMethod: (values) => {
          const Af = values['Af'];
          const Lf = values['Lf'];

          const Cf = Af / Lf;

          return Cf;
        },
      },
      {
        name: 'Profundidade dos filtros',
        variable: 'Pf',
        formula: 'Pf = 0.45 + 0.5 + 0.25',
        measurement: 'm',
        calculationMethod: (_values, transformer) => {
          const profundidadeCamadas = {
            antracito: 0.5,
            areia: 0.3,
          };

          let Pf = 0.5;
          transformer.forEach((t) => {
            Pf += profundidadeCamadas[t.id] || 0;
          });

          return Pf;
        },
      },
    ],
  },
);
